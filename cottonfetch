#!/bin/env bash

if [[ $* == *--help ]]; then
    echo
    echo -e "\e[1mcottonfetch v1.8\e[0m"
    echo "created by servalx4"
    echo -e "\e[3m\"all hail the holy cult of cotton!!\"\e[0m"
    echo
    echo "usage:"
    echo "cottonfetch | the fetch"
    echo "cottonfetch --help | this message"
    echo
    echo "thank you for using cottonfetch <3"
    echo
    echo "shoutout to Hikari on discord for helping me fix fonts, without them cottonfetch would not be possible anymore!"
    echo "shoutout to ImmaculateKatz (github) for helping me with a LOT of distro specific stuff!"
    echo

else

    # thanks Mikel !
    # this is what cottonfetch detects, very advanced, i know

    DISTRO=""

    if [ -f /etc/os-release ]; then
        . /etc/os-release
        
        DISTRO=$NAME
        
    elif type lsb_release >/dev/null 2>&1; then
    
        DISTRO=$(lsb_release -si)

    elif [ -f /etc/lsb-release ]; then
        . /etc/lsb-release
        DISTRO=$DISTRIB_ID

    elif [ -f /etc/debian_version ]; then
        DISTRO="Debian GNU/Linux"

    elif [ -f /etc/SuSe-release ]; then
        ...
        
    elif [ -f /etc/redhat-release ]; then
        ...
        
    else
        DISTRO=$(uname -s)
    fi

    
    if test -d /bedrock; then
        DISTRO='Bedrock'
    elif test -d /etc/GoboLinuxVersion; then
        DISTRO='Gobolinux'
    fi 
    

    OS=`uname -o`
    KERNEL=`uname`
    
    KERNELVER=`uname -r`

    # stackoverflow saves me once again...

    KVLENGTH=`expr "$KERNELVER" : '.*'`

    printf -v KERNELVER '%.*s' 15 "$KERNELVER"

    if (( KVLENGTH > 17 )); then
        KERNELVER=`echo $KERNELVER"..."`
    fi
    


    ARCH=`uname -m`
    HOST=`uname -n`
    USERNAME=`whoami`



    TEMP=`cat /proc/meminfo | grep "MemTotal"`
    TEMP2=`echo $TEMP | awk '{print $2}'`
    RAM=`echo $(($TEMP2 / 1024))`

    TEMP2=`cat /proc/meminfo | grep "MemFree:"`
    TEMP=`echo $TEMP2 | awk '{print $2}'`
    RAMFREE=`echo $(($TEMP / 1024))`

    RAMUSED=`echo $(($RAM - $RAMFREE))`

    TEMP=`cat /proc/meminfo | grep "SwapTotal"`
    TEMP2=`echo $TEMP | awk '{print $2}'`
    SWAP=`echo $(($TEMP2 / 1024))`

    TEMP2=`cat /proc/meminfo | grep "SwapFree:"`
    TEMP=`echo $TEMP2 | awk '{print $2}'`
    SWAPFREE=`echo $(($TEMP / 1024))`

    SWAPUSED=`echo $(($SWAP - $SWAPFREE))`



    if [[ "$OS" == 'Android' ]]; then
        TEMP=`cat /proc/cpuinfo | grep "Hardware" | sort | uniq`
        TEMP2="${TEMP//"Processor :"}"
    else
        TEMP=`cat /proc/cpuinfo | grep "model name" | sort | uniq`
        TEMP2="${TEMP//"Model name"}"
    fi
    
    CPU=`echo $TEMP2 | awk '{print $4" "$5" "$6" "$7" "$8" "$9" "$10" "$11" "$12" "$13" "$14" "$15" "$16" "$17" "$18" "$19" "$20" "$21}'`

    TEMP=`glxinfo | grep "Device"`
    GPU="${TEMP//"Device:"}"

    if ! [[ "$GPU" == '' ]]; then
        GPULENGTH=`expr "$GPU" : '.*'`

        printf -v GPU '%.*s' 50 "$GPU"

        if (( GPULENGTH > 50 )); then
            GPU=`echo $GPU"..."`
        fi

    else
        TEMP2=`lspci | grep "VGA"`
        GPU="${TEMP2//*"VGA compatible controller:"}"
        

        if [[ "$GPU" == '' ]]; then
            GPU="unknown/notfound"
        fi
    fi

    if [[ "$OS" == 'Android' ]]; then
        GPU="none"
    fi

    if [[ "$CPU" == '' ]]; then
        CPU="unknown"
    fi

    # thanks stackoverflow!

    NC='\e[0m'
    BLCK='\e[0;30m'
    DAGR='\e[1;30m'
    RED='\e[0;31m'
    LIRE='\e[1;31m'
    GREN='\e[0;32m'
    LIGN='\e[1;32m'
    ORNG='\e[0;33m'
    YLOW='\e[1;33m'
    BLUE='\e[0;34m'
    LIBL='\e[1;34m'
    PRPL='\e[0;35m'
    LIPR='\e[1;35m'
    CYAN='\e[0;36m'
    LICY='\e[1;36m'
    LIGR='\e[0;37m'
    WHTE='\e[1;37m'

    # aaand here are the distro logos!
    # MAKE SURE TO REPLACE SPACES WITH WHITESPACE ASCII CHARACTERS FOR IT WILL BREAK!!!

    case $DISTRO in
    'NixOS')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$LICY
	ICON='Ôåì';;
    'Debian GNU/Linux')
        DISTROCOLOUR=$RED
        ACCENTCOLOUR=$LIGR
	ICON='ÔåÜ';;
    'Arch Linux')
        DISTROCOLOUR=$CYAN
        ACCENTCOLOUR=$LICY
	ICON='ÔåÉ';;
    'Gentoo')
        DISTROCOLOUR=$LIGR
        ACCENTCOLOUR=$LIPR
	ICON='Ôåç';;
    'EndeavourOS') 
        DISTROCOLOUR=$LIPR
        ACCENTCOLOUR=$PRPL
	ICON='Ôå¢';;
    'Bedrock')
        DISTROCOLOUR=$LIGR
        ACCENTCOLOUR=$BLCK
	ICON='b';;
    'Android')
        DISTROCOLOUR=$GREN
        ACCENTCOLOUR=$GREN
	ICON='ÔÖª';;
    'Ubuntu')
        DISTROCOLOUR=$ORNG
        ACCENTCOLOUR=$YLOW
	ICON='Ôåõ';;
    'Fedora Linux')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$WHTE
	ICON='Ôåä';;
    'KaOS') # do people know this distro exists?
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$BLUE
	ICON='KÀ≥';;
    'Oreon')
        DISTROCOLOUR=$WHTE
        ACCENTCOLOUR=$LIGN
	ICON='Û∞õ∏';;
    'Void')
        DISTROCOLOUR=$LIGN
        ACCENTCOLOUR=$WHTE
	ICON='ÔåÆ';;
    'Solus')
        DISTROCOLOUR=$LIGR
        ACCENTCOLOUR=$BLUE
	ICON='Ôå≠';;
    'Red Hat Enterprise Linux')
        DISTROCOLOUR=$RED
        ACCENTCOLOUR=$LIRE
	ICON='ÓΩù';;
    'openSUSE')
        DISTROCOLOUR=$GREN
        ACCENTCOLOUR=$LIGN
	ICON='ÓΩ≠';;
    'FreeBSD')
        DISTROCOLOUR=$RED
        ACCENTCOLOUR=$BLCK
	ICON='Ôäè';;
    'Chimera')
        DISTROCOLOUR=$LIRE
        ACCENTCOLOUR=$LIPR
	ICON='ú¥´';;
    'Slackware')
        DISTROCOLOUR=$BLUE
        ACCENTCOLOUR=$BLCK
	ICON='Ôåò';;
    'SteamOS')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$LIPR
	ICON='‚Ä¢)';;
    'Guix System')
        DISTROCOLOUR=$YLOW
        ACCENTCOLOUR=$ORNG
	ICON='Ôå•';;
    'Manjaro Linux')
        DISTROCOLOUR=$LIGN
        ACCENTCOLOUR=$GREN
	ICON='Ôåí';;
    'Alpine Linux')
        DISTROCOLOUR=$BLUE
        ACCENTCOLOUR=$LIBL
	ICON='ÔåÄ';;
    'TinyCore')
        DISTROCOLOUR=$BLCK
        ACCENTCOLOUR=$LIGR
	ICON='c‚äòre';;
    'Gobolinux')
        DISTROCOLOUR=$CYAN
        ACCENTCOLOUR=$LIPR
	ICON='Ôçî';;
    'Artix Linux')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$LICY
	ICON='Ôåü';;
    'Fatdog64 Linux')
        DISTROCOLOUR=$WHTE
        ACCENTCOLOUR=$YLOW
	ICON='Û∞©É';;
    'Linux Mint')
        DISTROCOLOUR=$LIGN
        ACCENTCOLOUR=$WHTE
	ICON='Ôåé';;
    'Deepin')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$WHTE
	ICON='Ôå°';;
    'NuTyX')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$BLUE
	ICON='Óª∏';;
    *'Asahi'*)
        DISTROCOLOUR=$LIRE
        ACCENTCOLOUR=$BLCK
	ICON='Ó∫ò';;
    'ArcoLinux')
        DISTROCOLOUR=$LIBL
        ACCENTCOLOUR=$LIPR
	ICON='ÔçÜ';;
    'Archcraft')
        DISTROCOLOUR=$LICY
        ACCENTCOLOUR=$LIGN 
	ICON='ÔçÖ';;
    'Archbang')
        DISTROCOLOUR=$CYAN
        ACCENTCOLOUR=$BLUE
	ICON='ÔåÉÕÖ';;
    'MidOS')
        DISTROCOLOUR=$BLCK
        ACCENTCOLOUR=$WHTE
	ICON='<|>';;
    'Zorin OS')
        DISTROCOLOUR=$BLUE
        ACCENTCOLOUR=$WHTE
	ICON='ÔåØ';;
    'CachyOS'*)
        DISTROCOLOUR=$CYAN
        ACCENTCOLOUR=$LIGN
	ICON='C‚∏™';;
    'elementary OS')
        DISTROCOLOUR=$WHTE
        ACCENTCOLOUR=$LIGR
	ICON='Ôåâ';;
    'Pickle')
        DISTROCOLOUR=$GREN
        ACCENTCOLOUR=$YLOW
	ICON='O';;
    'PikaOS')
        DISTROCOLOUR=$YLOW
        ACCENTCOLOUR=$WHTE
	ICON='Û±óÜ';;
    esac
    LINE1='‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚†Ä‚£Ñ‚†Ä‚£Ä‚°†‚†Ñ‚†Ä‚†Ä'
    LINE2='‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚†Ä‚†∑‚£∂‚£å‚°á‚¢ø‚£ß‚°∏‚†Ä‚†Ä'
    LINE3='‚†Ä‚†Ä‚†Ä‚¢Ä‚£†‚£Ñ‚†Ä‚°ì‚†°‚°Ä‚†Ü‚†Ä‚†Ä‚†Ä‚†Ä'
    LINE4='‚†Ä‚†Ä‚†Ä‚†ª‚£ø‚£∂‚°Ü‚¢Å‚†à‚£Ä‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä'
    LINE5='‚†Ä‚†Ä‚¢†‚£Ä‚°Ä‚¢ß‚°Ñ‚†Å‚¢∞‚£∑‚°ä‚†Ä‚†Ä‚†Ä‚†Ä'
    LINE6='‚†Ä‚†Ä‚†à‚†õ‚†ø‚†∞‚†Ä‚†•‚†Ä‚†â‚†Å‚†Ä‚†Ä‚†Ä‚†Ä'
    LINE7='‚†Ä‚†Ä‚£∂‚°Ü‚¢ê‚†ì‚¢∂‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä'
    LINE8='‚†Ä‚†Ä‚†Ä‚†â‚†∏‚†Ä‚†Ä‚†°‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä'
    EMPTY='‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ‚ÄÉ'

    # THIS IS THE PART IT PRINTS OUT!!! THIS IS WHAT YOU WANT TO EDIT IF YOU WANT TO CUSTOMIZE IT!!

    echo
    echo -e ${DISTROCOLOUR}$EMPTY${NC} ${DISTROCOLOUR}$USERNAME${NC}"@"${ACCENTCOLOUR}$HOST
    echo -e ${DISTROCOLOUR}$LINE1${NC} "‚îå "${ACCENTCOLOUR}"os"
    echo -e ${DISTROCOLOUR}$LINE2${NC} "type ‚ñ∫"${DISTROCOLOUR} $ICON $DISTRO
    echo -e ${DISTROCOLOUR}$LINE3${NC} "krnl ‚ñ∫"${DISTROCOLOUR} $KERNEL ${NC}$KERNELVER
    echo -e ${DISTROCOLOUR}$LINE4${NC} "arch ‚ñ∫"${DISTROCOLOUR} $ARCH
    echo -e ${DISTROCOLOUR}$LINE5${NC}
    echo -e ${DISTROCOLOUR}$LINE6${NC} "‚îå "${ACCENTCOLOUR}"pc"${NC}
    echo -e ${DISTROCOLOUR}$LINE7${NC} "ram ‚ñ∫"${DISTROCOLOUR} $RAMUSED"/"$RAM"MB," ${NC}$SWAPUSED"/"$SWAP"MB Swap"
    echo -e ${DISTROCOLOUR}$LINE8${NC} "cpu ‚ñ∫"${DISTROCOLOUR} $CPU 
    echo -e ${DISTROCOLOUR}$EMPTY${NC} "gpu ‚ñ∫"${DISTROCOLOUR} $GPU
    echo -e ${DISTROCOLOUR}$EMPTY${NC}
    echo -e ${DISTROCOLOUR}$EMPTY${NC} "‚îå "${ACCENTCOLOUR}"display"${LIGR}
    echo -e ${DISTROCOLOUR}$EMPTY${NC} "de/wm  ‚ñ∫"${DISTROCOLOUR} $XDG_CURRENT_DESKTOP 
    echo -e ${DISTROCOLOUR}$EMPTY${NC} "server ‚ñ∫"${DISTROCOLOUR} $XDG_SESSION_TYPE${NC}
    echo
fi



# Fish support
#                           .
#                           A       ;
#                 |   ,--,-/ \---,-/|  ,
#                _|\,'. /|      /|   `/|-.
#            \`.'    /|      ,            `;.
#           ,'\   A     A         A   A _ /| `.;
#         ,/  _              A       _  / _   /|  ;
#        /\  / \   ,  ,           A  /    /     `/|
#       /_| | _ \         ,     ,             ,/  \
#      // | |/ `.\  ,-      ,       ,   ,/ ,/      \/
#      / @| |@  / /'   \  \      ,              >  /|    ,--.
#     |\_/   \_/ /      |  |           ,  ,/        \  ./' __:..
#     |  __ __  |       |  | .--.  ,         >  >   |-'   /     `
#   ,/| /  '  \ |       |  |     \      ,           |    /
#  /  |<--.__,->|       |  | .    `.        >  >    /   (
# /_,' \\  ^  /  \     /  /   `.    >--            /^\   |
#       \\___/    \   /  /      \__'     \   \   \/   \  |
#        `.   |/          ,  ,                  /`\    \  )
#          \  '  |/    ,       V    \          /        `-\
#           `|/  '  V      V           \    \.'            \_
#            '`-.       V       V        \./'\
#                `|/-.      \ /   \ /,---`\         kat
#                 /   `._____V_____V'
#                            '     '
